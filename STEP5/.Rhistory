# Loading packages
library(xlsx)
library(ggplot2)
# Loading data
setwd("/home/guest/Traineeship/Scripts/STEP4")
# Loading data
setwd("/home/guest/Traineeship/Scripts/STEP5")
data <- read.xlsx("MA_DIM_Results.xlsx",1,header=TRUE)
# Subsetting data
subset <- data.frame(data$Locus.tag, data$Species, data$NA., data$NA..1, data$NA..3, data$NA..4)
subset2 <- subset[1:30, ]
View(data)
# Making heatmap
ggplot(subset2, aes(x=data.Locus.tag, y=data.Species)) +
geom_tile()
View(data)
View(subset2)
TRY1 <- subset2 %>%
gather(Species, Value, startsWith("M"))
install.packages("magrittr")
install.packages("magrittr")
install.packages("magrittr")
install.packages("magrittr")
library(magrittr)
TRY1 <- subset2 %>%
gather(Species, Value, startsWith("M"))
library(tidyr)
TRY1 <- subset2 %>%
gather(Species, Value, startsWith("M"))
# Loading packages
library(xlsx)
library(ggplot2)
library(magrittr)
library(tidyr)
# Loading data
setwd("/home/guest/Traineeship/Scripts/STEP5")
data <- read.xlsx("MA_DIM_Results.xlsx",1,header=TRUE)
# Subsetting data
subset <- data.frame(data$Locus.tag, data$Species, data$NA., data$NA..1, data$NA..3, data$NA..4)
subset2 <- subset[1:30, ]
# Making heatmap
ggplot(subset2, aes(x=data.Locus.tag, y=data.Species)) +
geom_tile()
# Loading packages
library(xlsx)
library(ggplot2)
library(magrittr)
library(tidyr)
# Loading data
setwd("/home/guest/Traineeship/Scripts/STEP5")
data <- read.xlsx("MA_DIM_Results_NoHead.xlsx",1,header=TRUE)
# Subsetting data (not using all of it)
subset <- data.frame(data$Locus.tag, data$Species, data$NA., data$NA..1, data$NA..3, data$NA..4)
View(data)
data <- read.xlsx("MA_DIM_Results_NoHead.xlsx",1,header=TRUE)
View(data)
# Loading packages
library(xlsx)
library(ggplot2)
library(magrittr)
library(tidyr)
View(data)
View(data)
# Subsetting data (not using all of it)
subset <- data.frame(data$Locus.tag, data$Candidatus.M.alkanivorans, data$M.ahvazicum,data$M.alsense)
View(subset)
subset2 <- as.data.frame(t(subset))
View(subset)
View(subset2)
data <- read.xlsx("MA_DIM_Results_NoHead.xlsx",1,header=TRUE)
View(data)
head(data)
# Subsetting data (not using all of it)
subset <- data.frame(data$NA., data$Candidatus.M.alkanivorans, data$M.ahvazicum,data$M.alsense)
View(subset)
subset2 <- as.data.frame(t(subset))
subset$data.NA.<- rownames(subset)
data <- read.xlsx("MA_DIM_Results_NoHead.xlsx",1,header=TRUE)
View(data)
View(data)
# Subsetting data (not using all of it)
subset <- data.frame(data$Locus.tag, data$Candidatus.M.alkanivorans, data$M.ahvazicum,data$M.alsense)
View(subset)
#subset2 <- as.data.frame(t(subset))
subset$data.Locus.tag<- rownames(subset)
View(subset)
subset2 <- subset[1:30, ]
View(subset2)
subset2$data.Locus.tag<- rownames(subset2)
View(subset2)
subset3 <- melt(subset2, id.vars=c("data.Locus.tag"))
install.packages("reshape2")
library(reshape2)
subset3 <- melt(subset2, id.vars=c("data.Locus.tag"))
View(subset3)
# Making heatmap
ggplot(subset3, aes(x=as.numeric(data.Locus.tag), y=value)) +
geom_tile()
# Making heatmap
ggplot(subset3, aes(x=as.numeric(data.Locus.tag), y=variable)) +
geom_tile()
# Making heatmap
ggplot(subset3, aes(x=as.numeric(data.Locus.tag), y=variable, color=value)) +
geom_tile()
View(subset3)
View(subset)
View(subset2)
View(subset)
View(data)
# Subsetting data (not using all of it)
subset <- data.frame(data$Locus.tag, data$Candidatus.M.alkanivorans, data$M.ahvazicum,data$M.alsense)
View(subset)
subset2 <- subset[1:30, ]
View(subset2)
row.names(subset2) <- subset$data.Locus.tag
row.names(subset2) <- subset2$data.Locus.tag
subset2 <- subset2[,-1]
subset3 <- melt(subset2, id.vars=c("data.Locus.tag"))
subset3 <- melt(subset2)
View(subset3)
data <- read.xlsx("MA_DIM_Results_NoHead.xlsx",1,header=TRUE)
# Subsetting data (not using all of it)
subset <- data.frame(data$Locus.tag, data$Candidatus.M.alkanivorans, data$M.ahvazicum,data$M.alsense)
subset2 <- subset[1:30, ]
row.names(subset2) <- subset2$data.Locus.tag
View(subset2)
subset3 <- melt(subset2, id.vars=c("data.Locus.tag"))
View(subset3)
View(subset3)
# Making heatmap
ggplot(subset3, aes(x=as.numeric(data.Locus.tag), y=variable, color=value)) +
geom_tile()
# Making heatmap
ggplot(subset3, aes(x=data.Locus.tag, y=variable)) +
geom_tile()
# Making heatmap
ggplot(subset3, aes(x=data.Locus.tag, y=variable, color=value)) +
geom_tile()
# Making heatmap
ggplot(subset3, aes(x=data.Locus.tag, y=variable)) +
geom_tile() +
ggtitle("Presence/absence of MA DIM genes")
# Making heatmap
ggplot(subset3, aes(x=data.Locus.tag, y=variable, color=value)) +
geom_tile() +
ggtitle("Presence/absence of MA DIM genes")
# Making heatmap
ggplot(subset3, aes(x=data.Locus.tag, y=variable, color=value, fill=value)) +
geom_tile() +
ggtitle("Presence/absence of MA DIM genes")
# Making heatmap
ggplot(subset3, aes(x=data.Locus.tag, y=variable, #color=value,
fill=value)) +
geom_tile() +
ggtitle("Presence/absence of MA DIM genes")
# Making heatmap
ggplot(subset3, aes(x=data.Locus.tag, y=variable, fill=value)) +
geom_tile(position="dodge") +
ggtitle("Presence/absence of MA DIM genes") +
theme()
# Making heatmap
ggplot(subset3, aes(x=data.Locus.tag, y=variable, fill=value)) +
geom_tile(stat="identity") +
ggtitle("Presence/absence of MA DIM genes") +
theme()
# Subsetting data (not using all of it)
subset <- data.frame(data$Locus.tag, data$Candidatus.M.alkanivorans, data$M.ahvazicum,data$M.alsense,data$M.angelicum,data$M.avium.subsp..avium,data$M.avium.subsp..hominissuis)
subset2 <- subset[1:30, ]
# Putting first column as row names and keeping the first column
row.names(subset2) <- subset2$data.Locus.tag
# Melting dataframe so everything because data in columns
subset3 <- melt(subset2, id.vars=c("data.Locus.tag"))
# Making heatmap
ggplot(subset3, aes(x=data.Locus.tag, y=variable, fill=value)) +
geom_tile(stat="identity") +
ggtitle("Presence/absence of MA DIM genes") +
theme()
# Making heatmap
ggplot(subset3, aes(x=data.Locus.tag, y=variable, fill=value)) +
geom_tile(stat="identity") +
ggtitle("Presence/absence of MA DIM genes") +
theme_ipsum()
# Making heatmap
ggplot(subset3, aes(x=data.Locus.tag, y=variable, fill=value)) +
geom_tile(stat="identity") +
ggtitle("Presence/absence of MA DIM genes") +
theme(axis.text.x=element_text(angle=45, vjust=1, hjust=1))
# Making heatmap
ggplot(subset3, aes(x=data.Locus.tag, y=variable, fill=value)) +
geom_tile() +
ggtitle("Presence/absence of MA DIM genes") +
theme(axis.text.x=element_text(angle=45, vjust=1, hjust=1))
# Making heatmap
ggplot(subset3, aes(x=data.Locus.tag, y=variable, fill=value)) +
geom_tile() +
ggtitle("Presence/absence of MA DIM genes") +
theme_bw() +
theme(axis.text.x=element_text(angle=45, vjust=1, hjust=1))
# Making heatmap
ggplot(subset3, aes(x=data.Locus.tag, y=variable, fill=value)) +
geom_tile() +
ggtitle("Presence/absence of MA DIM genes") +
theme(axis.text.x=element_text(angle=45, vjust=1, hjust=1))
# Making heatmap
ggplot(subset3, aes(x=data.Locus.tag, y=variable, fill=value)) +
geom_tile() +
ggtitle("Presence/absence of MA DIM genes") +
theme(axis.text.x=element_text(angle=45, vjust=1, hjust=1),
panel.background=element_blank(),
panel.grid.major=element_blank())
# Making heatmap
ggplot(subset3, aes(x=data.Locus.tag, y=variable, fill=value)) +
geom_tile() +
#ggtitle("Presence/absence of MA DIM genes") +
theme(axis.text.x=element_text(angle=45, vjust=1, hjust=1),
panel.background=element_blank(),
panel.grid.major=element_blank(),
legend.position="top")
# Making heatmap
ggplot(subset3, aes(x=data.Locus.tag, y=variable, fill=value)) +
geom_tile() +
#ggtitle("Presence/absence of MA DIM genes") +
scale_x_discrete(position="top") +
theme(axis.text.x=element_text(angle=45, vjust=1, hjust=1),
panel.background=element_blank(),
panel.grid.major=element_blank(),
legend.position="top")
# Making heatmap
ggplot(subset3, aes(x=data.Locus.tag, y=variable, fill=value)) +
geom_tile() +
#ggtitle("Presence/absence of MA DIM genes") +
scale_x_discrete(position="top") +
theme(axis.text.x=element_text(angle=45, vjust=0, hjust=1),
panel.background=element_blank(),
panel.grid.major=element_blank(),
legend.position="top")
# Making heatmap
ggplot(subset3, aes(x=data.Locus.tag, y=variable, fill=value)) +
geom_tile() +
#ggtitle("Presence/absence of MA DIM genes") +
scale_x_discrete(position="top") +
theme(axis.text.x=element_text(angle=45, vjust=1, hjust=0),
panel.background=element_blank(),
panel.grid.major=element_blank(),
legend.position="top")
# Making heatmap
ggplot(subset3, aes(x=data.Locus.tag, y=variable, fill=value)) +
geom_tile() +
#ggtitle("Presence/absence of MA DIM genes") +
scale_x_discrete(position="top") +
theme(axis.text.x=element_text(angle=45, vjust=1, hjust=0),
panel.background=element_blank(),
panel.grid.major=element_blank(),
legend.position="topleft")
# Making heatmap
ggplot(subset3, aes(x=data.Locus.tag, y=variable, fill=value)) +
geom_tile() +
#ggtitle("Presence/absence of MA DIM genes") +
scale_x_discrete(position="top") +
scale_y_discrete(position="right")
# Making heatmap
ggplot(subset3, aes(x=data.Locus.tag, y=variable, fill=value)) +
geom_tile() +
#ggtitle("Presence/absence of MA DIM genes") +
scale_x_discrete(position="top") +
scale_y_discrete(position="right") +
theme(axis.text.x=element_text(angle=45, vjust=1, hjust=0),
panel.background=element_blank(),
panel.grid.major=element_blank(),
legend.position="top")
View(data)
# Making heatmap
ggplot(subset3, aes(x=data.Locus.tag, y=variable, fill=value)) +
geom_tile() +
#ggtitle("Presence/absence of MA DIM genes") +
scale_x_discrete(position="top") +
scale_y_discrete(position="right") +
theme(axis.text.x=element_text(angle=45, vjust=1, hjust=0),
axis.title.x=element_blank(),
axis.title.y=element_blank(),
panel.background=element_blank(),
panel.grid.major=element_blank(),
legend.position="top")
# Making heatmap
ggplot(subset3, aes(x=data.Locus.tag, y=variable, fill=value)) +
geom_tile() +
#ggtitle("Presence/absence of MA DIM genes") +
scale_x_discrete(position="top") +
scale_y_discrete(position="right") +
theme(axis.text.x=element_text(angle=45, vjust=1, hjust=0),
axis.title.x=element_blank(),
axis.title.y=element_blank(),
panel.background=element_blank(),
panel.grid.major=element_blank(),
legend.position="top",
legend.title=element_blank())
# Making heatmap
ggplot(subset3, aes(x=data.Locus.tag, y=variable, fill=value)) +
geom_tile() +
#ggtitle("Presence/absence of MA DIM genes") +
scale_x_discrete(position="top") +
scale_y_discrete(position="right") +
scale_fill_discrete(labels=c("Gene absent","Gene present")) +
theme(axis.text.x=element_text(angle=45, vjust=1, hjust=0),
axis.title.x=element_blank(),
axis.title.y=element_blank(),
panel.background=element_blank(),
panel.grid.major=element_blank(),
legend.position="top",
legend.title=element_blank())
View(subset3)
subset4 <- transform(subset3, variable = sub("data.","",Species))
subset4 <- transform(subset3, variable = sub("data.","",variable))
View(subset4)
# Making heatmap
ggplot(subset4, aes(x=data.Locus.tag, y=variable, fill=value)) +
geom_tile() +
#ggtitle("Presence/absence of MA DIM genes") +
scale_x_discrete(position="top") +
scale_y_discrete(position="right") +
scale_fill_discrete(labels=c("Gene absent","Gene present")) +
theme(axis.text.x=element_text(angle=45, vjust=1, hjust=0),
axis.title.x=element_blank(),
axis.title.y=element_blank(),
panel.background=element_blank(),
panel.grid.major=element_blank(),
legend.position="top",
legend.title=element_blank())
